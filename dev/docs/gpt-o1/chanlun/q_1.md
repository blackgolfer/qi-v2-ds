$\newcommand{\D}{\mathfrak{D}}$
$\newcommand{\Op}{\mathfrak{O}}$
$\newcommand{\op}{\mathfrak{o}}$
$\newcommand{\DS}{\mathfrak{S}}$
$\newcommand{\M}{\mathfrak{M}}$
$\newcommand{\DP}{\mathfrak{P}}$
$\newcommand{\C}{\mathfrak{C}}$

# A Multi Time-scale Finite State Machine Application Framework

## Attraction

### Data source
#### Raw data source
Consider a raw source $S$ consisting of multiple data streams. Let each stream contain elements of the same type, denoted by $\D$. Formally, define the raw source as:
$$S = \{s_1, s_2, \ldots, s_n\}$$
where: $s_i$ represents the $i$-th stream in the raw source $S$. $d_{ij}$ denotes the $j$-th element within the $i$-th stream $s_i$, such that $d_{ij} \in\D$.

The total number of streams $n$ is on the order of 1,000.

#### Multi time-scale finite state machine (MTSFSM) operator
A MTFSM operator maps the raw data source $S$ to $M$.

In what follows, we limit ourself to a particular type of MTFSM operator, let's call it $C$, with the following properties:
1. Associative to $S$:
   $$ C(S)=C(\{s_1,s_2, \ldots, s_n\})=\{C(s_1), C(s_2), \ldots, C(s_n)\}$$
2. Chainable: $\forall s\in S$,
   $$
   C(s)=\left[
   \begin{matrix}
   c_1(s) &\\
   c_2(c1(s)) \\
   \dots \\
   c_m(c_{m-1}(\dots c_1(s)))
   \end{matrix}
   \right]
   $$
   where $c_i$ is an operator that takes the output of $c_{i-1}$ as input, for $i=2,\ldots,m$ for some positive integer $m$. Notice that $c_1$ is also a MTFSFSM operator. Let's use $.$ to denote composition, and $C_i=c_i.c_{i-1}.\ \dots .c_1$, so that,
   $$
   C(s)=\left[
   \begin{matrix}
   C_1(s) &\\
   C_2(s) \\
   \dots \\
   C_m(s)
   \end{matrix}
   \right], \forall s\in S.
   $$
3. Each operator $c_i$ has similar output structure, it basically is a partition of the stream $s$, where $s\in S$, in the time domain with extra attributes. To be precise, let $\DP=\{[t_i, t_{i+1}], for\ i=0,1,2,\ldots,n, n\in\N\}$ be the time axis partition, where $\N$ is the positive integer set and $t_i$ is the timestamp. To emphasize the dependency, we use $\DP_s$ for $\DP$, if the partition element $t_i$ is from the $i^{th}$ element in $s\in S$. Let $a_i$ be the set of attributes for $C_i$, then we have $C_i: s\to\{p\in\DP_s,a_i\}$, $\forall s\in S$.

#### The data set
The data set in the system is the combination of $S$ and $C$. Denote the data set by $D$, and organize the data as follows. $D=\{d_1,d_2,\ldots,d_n\}$, where $d_i=\{s_i, C(s_i)\}$, $i=1,2,\ldots,n$. In more detail,
$$d_i=\{s_i, \{C_1(s_i),C_2(s_i),\ldots,C_m(s_i)\}\}$$

## Applications
An application $A$ is a function that map $D$ to some output.

### Applications with associative (respective to data source) property
We call application $A$ associative, if $A(D)=A(\{d_1,d_2, \ldots, d_n\})=\{A(d_1), A(d_2), \ldots, A(d_n)\}$.


## tradingview charting library application
tradingview application is associative, it maps data set to screen.